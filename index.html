<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>YouTube Downloader</title>

<!-- Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">

<style>
/* ===== Global ===== */
* {
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Poppins', Arial, sans-serif;
}

body {
  background:#050505;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  color:#e5e7eb;
  position:relative;
}
/* ===== Bubble Background ===== */
.bubble {
  position:absolute;
  bottom:0;
  border-radius:50%;
  background:#ff0000;
  opacity:0.6;
  animation:floatUp linear forwards;
}

@keyframes floatUp {
  0% {
    transform: translateY(0) scale(0.5);
    opacity:0.3;
  }
  50% {
    opacity:0.8;
  }
  100% {
    transform: translateY(-150vh) scale(1);
    opacity:0;
  }
}
/* ===== Container ===== */
.container {
  max-width:700px;
  width:100%;
  padding:20px;
  text-align:center;
  position:relative;
  z-index:1;
}

/* ===== Heading ===== */
h1 {
  color:#ff2222;
  margin-bottom:20px;
}

/* ===== Boxes (VIDEO / AUDIO) ===== */
.box {
  width:340px;
  margin:20px auto;
  padding:26px;
  background:#0b0b0b;
  border-radius:18px;
  text-align:center;
  position:relative;
  overflow:hidden;
}

/* ===== Animated Border ===== */
@property --angle {
  syntax:"<angle>";
  initial-value:0deg;
  inherits:false;
}

.box::before,
.box::after {
  content:"";
  position:absolute;
  inset:-3px;
  border-radius:20px;
  background:conic-gradient(
    from var(--angle),
    #ff0000,
    #000,
    #ff0000
  );
  z-index:-1;
  animation:spin 3.5s linear infinite;
}

.box::before {
  filter:blur(1.4rem);
  opacity:.75;
}

@keyframes spin {
  to{--angle:360deg;}
}

/* ===== Titles inside boxes ===== */
.box h2 {
  color:#ff0000;
  margin-bottom:12px;
}

/* ===== Input ===== */
input {
  width:100%;
  padding:12px;
  border-radius:6px;
  border:none;
  outline:none;
  margin-bottom:12px;
  font-size:16px;
}

/* ===== Button ===== */
button {
  padding:12px 20px;
  background:#ff0000;
  border:none;
  border-radius:12px;
  font-weight:600;
  color:#fff;
  cursor:pointer;
  transition:.25s;
  box-shadow:0 0 10px #ff0000;
}

button:hover {
  background:#000;
  color:#ff0000;
  box-shadow:0 0 20px #ff0000, 0 0 40px #ff0000;
}

/* ===== Video & Audio List Styling ===== */
#videoList, #audioList {
  display:flex;
  flex-direction:column;
  gap:10px;
}

.download-btn {
  display:inline-block;
  padding:8px 14px;
  background:#ff0000;
  color:#fff;
  border-radius:6px;
  text-decoration:none;
  font-weight:bold;
  transition:.25s;
}

.download-btn:hover {
  background:#000;
  color:#ff0000;
  box-shadow:0 0 15px #ff0000;
}
</style>
</head>
<body>

<div class="container">

  <h1>ðŸŽ¬ DTZ YT DOWNLOADER</h1>

  <input
    id="yturl"
    type="text"
    placeholder="Paste YouTube link here"
  >

  <button onclick="fetchVideo()">Fetch Qualities</button>

  <h3 id="title"></h3>

  <!-- Thumbnail Image -->
  <img id="thumbnail" alt="Video Thumbnail" style="display:none; max-width:480px; width:100%; height:auto; border-radius:12px; margin:20px auto; box-shadow:0 0 20px rgba(255,0,0,0.5);">

  <div class="box">
    <h2>ðŸ“¹ VIDEO</h2>
    <div id="videoList"></div>
  </div>

  <div class="box">
    <h2>ðŸŽµ AUDIO</h2>
    <div id="audioList"></div>
  </div>

</div>

<script>
// Bubbles directly appended to body (fixed missing div issue)
<script>
// Bubbles code same à¶­à·’à¶ºà·™à¶±à·Šà¶±...

async function downloadFile(url, filename) {
  try {
    const response = await fetch(url);
    if (!response.ok) throw new Error("Download failed");
    
    const blob = await response.blob();
    const blobUrl = window.URL.createObjectURL(blob);
    
    const a = document.createElement('a');
    a.style.display = 'none';
    a.href = blobUrl;
    a.download = filename;  // à¶¸à·™à¶­à¶± filename à¶‘à¶š force à¶šà¶»à¶±à·€à·
    document.body.appendChild(a);
    a.click();
    
    window.URL.revokeObjectURL(blobUrl);
    document.body.removeChild(a);
  } catch (e) {
    alert("Download failed! Opening in new tab instead.");
    window.open(url, '_blank'); // fallback
  }
}

async function fetchVideo() {
  const yt = document.getElementById("yturl").value.trim();
  if (!yt) return alert("Paste YouTube link");

  document.getElementById("title").innerText = "Loading...";
  document.getElementById("thumbnail").style.display = "none";
  document.getElementById("videoList").innerHTML = "";
  document.getElementById("audioList").innerHTML = "";

  const API = `https://api.bk9.dev/download/youtube?url=${encodeURIComponent(yt)}`;

  try {
    const res = await fetch(API);
    const json = await res.json();

    if (!json.status || !json.BK9) {
      document.getElementById("title").innerText = "Failed to fetch data";
      return;
    }

    const data = json.BK9;
    const formats = data.formats || [];

    document.getElementById("title").innerText = data.title || "Unknown Title";

    // Thumbnail same à¶­à·’à¶ºà·™à¶±à·Šà¶±...

    const thumbImg = document.getElementById("thumbnail");
    let thumbUrl = data.thumbnail || "";
    if (thumbUrl) {
      thumbUrl = thumbUrl.split("?")[0].replace("default.jpg", "hqdefault.jpg");
      thumbImg.src = thumbUrl;
      thumbImg.alt = "Thumbnail for " + (data.title || "video");
      thumbImg.style.display = "block";
    }

    // VIDEO
    const videos = formats.filter(f => f.type === "video");
    document.getElementById("videoList").innerHTML = videos.length
      ? videos.map(v => {
          const qualityLabel = v.quality || "Unknown";
          const fps = v.fps ? `${v.fps}fps` : "";
          const bitrate = v.bitrate ? `| ${v.bitrate}` : "";
          const ext = v.mime?.includes("webm") ? "webm" : "mp4";
          const filename = `${data.title || "video"} - ${qualityLabel} ${fps} \( {bitrate}. \){ext}`.replace(/[/\\?%*:|"<>]/g, '-').trim();

          return `
            <a class="download-btn" href="javascript:void(0)" 
               onclick="downloadFile('\( {v.url}', ' \){filename}')">
              ${qualityLabel} ${fps} ${bitrate}
            </a>
          `;
        }).join("")
      : "<p>No video formats available</p>";

    // AUDIO
    const audios = formats.filter(f => f.type !== "video");
    document.getElementById("audioList").innerHTML = audios.length
      ? audios.map(a => {
          const bitrate = a.bitrate ? `| ${a.bitrate}` : "";
          const ext = a.mime?.includes("webm") ? "webm" : "m4a";
          const filename = `${data.title || "audio"} - Audio \( {bitrate}. \){ext}`.replace(/[/\\?%*:|"<>]/g, '-').trim();

          return `
            <a class="download-btn" href="javascript:void(0)" 
               onclick="downloadFile('\( {a.url}', ' \){filename}')">
              Audio ${bitrate}
            </a>
          `;
        }).join("")
      : "<p>No audio formats available</p>";

  } catch (e) {
    document.getElementById("title").innerText = "Error fetching data";
    console.error(e);
  }
}
</script>
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>YouTube Downloader</title>

<!-- Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">

<style>
/* ===== Global ===== */
* {
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Poppins', Arial, sans-serif;
}

body {
  background:#050505;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  color:#e5e7eb;
  position:relative;
}
/* ===== Bubble Background ===== */
.bubble {
  position:absolute;
  bottom:0;
  border-radius:50%;
  background:#ff0000;
  opacity:0.6;
  animation:floatUp linear forwards;
}

@keyframes floatUp {
  0% {
    transform: translateY(0) scale(0.5);
    opacity:0.3;
  }
  50% {
    opacity:0.8;
  }
  100% {
    transform: translateY(-150vh) scale(1);
    opacity:0;
  }
}
/* ===== Container ===== */
.container {
  max-width:700px;
  width:100%;
  padding:20px;
  text-align:center;
  position:relative;
  z-index:1;
}

/* ===== Heading ===== */
h1 {
  color:#ff2222;
  margin-bottom:20px;
}

/* ===== Boxes (VIDEO / AUDIO) ===== */
.box {
  width:340px;
  margin:20px auto;
  padding:26px;
  background:#0b0b0b;
  border-radius:18px;
  text-align:center;
  position:relative;
  overflow:hidden;
}

/* ===== Animated Border ===== */
@property --angle {
  syntax:"<angle>";
  initial-value:0deg;
  inherits:false;
}

.box::before,
.box::after {
  content:"";
  position:absolute;
  inset:-3px;
  border-radius:20px;
  background:conic-gradient(
    from var(--angle),
    #ff0000,
    #000,
    #ff0000
  );
  z-index:-1;
  animation:spin 3.5s linear infinite;
}

.box::before {
  filter:blur(1.4rem);
  opacity:.75;
}

@keyframes spin {
  to{--angle:360deg;}
}

/* ===== Titles inside boxes ===== */
.box h2 {
  color:#ff0000;
  margin-bottom:12px;
}

/* ===== Input ===== */
input {
  width:100%;
  padding:12px;
  border-radius:6px;
  border:none;
  outline:none;
  margin-bottom:12px;
  font-size:16px;
}

/* ===== Button ===== */
button {
  padding:12px 20px;
  background:#ff0000;
  border:none;
  border-radius:12px;
  font-weight:600;
  color:#fff;
  cursor:pointer;
  transition:.25s;
  box-shadow:0 0 10px #ff0000;
}

button:hover {
  background:#000;
  color:#ff0000;
  box-shadow:0 0 20px #ff0000, 0 0 40px #ff0000;
}

/* ===== Video & Audio List Styling ===== */
#videoList, #audioList {
  display:flex;
  flex-direction:column;
  gap:10px;
}

.download-btn {
  display:inline-block;
  padding:8px 14px;
  background:#ff0000;
  color:#fff;
  border-radius:6px;
  text-decoration:none;
  font-weight:bold;
  transition:.25s;
}

.download-btn:hover {
  background:#000;
  color:#ff0000;
  box-shadow:0 0 15px #ff0000;
}

/* NEW: Notice Bar */
/* ===== Animated Border ===== */
@property --angle {
syntax:"<angle>";
initial-value:0deg;
inherits:true;
}
#notice {
  margin: 18px auto;
  width: 100%;
  max-width: 480px;
  font-size: 14px;
  text-align: center;
  line-height: 1.4;
  padding: 16px;
  text-align: center;
  color: #ffaaaa;
  font-weight: bold;
  background: #0b0b0b;
  border-radius: 18px;
  position: relative;
}
#notice {
  border-top: 1px solid rgba(255,0,01,0.3);
  padding-top: 1px;
}
#notice::before,
#notice::after {
content: "";
position: absolute;
inset: -3px;
border-radius: 20px;
background: conic-gradient(
from var(--angle),
transparent 65%,
#ff0000,
#ff0001,
#ff0011
);
z-index: -1;
animation: spin 3.5s linear infinite;
}

#notice::before {
filter: blur(1.4rem);
opacity: .75;
}

@keyframes spin {
to {
--angle: 360deg;
}
}


/* NEW: Loading Overlay */
#loadingOverlay {
  position:fixed;
  top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.9);
  display:none;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  z-index:99;
  color:#fff;
}
.spinner {
  width:60px;
  height:60px;
  border:6px solid #333;
  border-top:6px solid #ff0000;
  border-radius:50%;
  animation:spinLoader 1s linear infinite;
}
@keyframes spinLoader { to { transform:rotate(360deg); } }

/* NEW: Language Popup */
#langPopup {
  position:fixed;
  top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.95);
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  z-index:101;
}
#langPopup button {
  padding:15px 40px;
  margin:10px;
  background:#ff0000;
  color:#fff;
  border:none;
  border-radius:12px;
  font-size:20px;
  cursor:pointer;
  box-shadow:0 0 15px #ff0000;
}
</style>
</head>
<body>

<!-- NEW: Loading Overlay -->
<div id="loadingOverlay">
  <div class="spinner"></div>
  <p id="loadingText">Loading...</p>
</div>

<!-- NEW: Language Popup -->
<div id="langPopup">
  <h2 style="color:#ff2222; margin-bottom:30px;">‡∂∑‡∑è‡∑Ç‡∑è‡∑Ä ‡∂≠‡∑ù‡∂ª‡∂±‡∑ä‡∂± / Select Language</h2>
  <button onclick="setLang('si')">‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω</button>
  <button onclick="setLang('en')">English</button>
</div>

<div class="container">

  <h1 id="mainTitle">üé¨ DTZ YT DOWNLOADER</h1>

  <input
    id="yturl"
    type="text"
    placeholder="Paste YouTube link here"
  >

  <button onclick="fetchVideo()">DOWNLOAD</button>

<!-- Notice under download button -->
<div id="notice">
  Download button ‡∂ë‡∂ö click ‡∂ö‡∑Ö‡∑è‡∂∏ ‡∂≠‡∑Ä page ‡∂ë‡∂ö‡∂ö‡∂ß redirect ‡∑Ä‡∑ô‡∂∫‡∑í.
  ‡∂ë‡∂≠‡∂± ‚ãÆ (three dots) menu ‡∂ë‡∂ö click ‡∂ö‡∂ª‡∂Ω‡∑è download ‡∂ö‡∂ª‡∂ú‡∂±‡∑ä‡∂±!
</div>

  <h3 id="title"></h3>

  <!-- Thumbnail Image -->
  <img id="thumbnail" alt="Video Thumbnail" style="display:none; max-width:480px; width:100%; height:auto; border-radius:12px; margin:20px auto; box-shadow:0 0 20px rgba(255,0,0,0.5);">

 <div id="resultArea" style="display:none;">

  <div class="box">
    <h2 id="videoBoxTitle">üìπ VIDEO</h2>
    <div id="videoList"></div>
  </div>

  <div class="box">
    <h2 id="audioBoxTitle">üéµ AUDIO</h2>
    <div id="audioList"></div>
  </div>

</div>

<script>
// Bubbles
function createBubble() {
  const bubble = document.createElement('div');
  bubble.classList.add('bubble');

  const size = Math.random() * 8 + 4;
  bubble.style.width = size + 'px';
  bubble.style.height = size + 'px';

  bubble.style.left = Math.random() * 100 + '%';

  bubble.style.animationDuration = (Math.random() * 2 + 2) + 's';

  document.body.appendChild(bubble);

  setTimeout(() => {
    bubble.remove();
  }, 4000);
}

setInterval(createBubble, 20);

// NEW: Language System
  const a = "you";
let lang = 'en';
const texts = {
  en: {
    mainTitle: "üé¨ DTZ YT DOWNLOADER",
    placeholder: "Paste YouTube link here",
    fetchBtn: "Fetch Qualities",
    videoBox: "üìπ VIDEO",
    audioBox: "üéµ AUDIO",
    loading: "Loading...",
    notice: "When you click Download button, it redirects to another page. Click the ‚ãÆ (three dots) menu there to download!"
  },
  si: {
    mainTitle: "üé¨ DTZ YT DOWNLOADER",
    placeholder: "YouTube link ‡∂ë‡∂ö paste ‡∂ö‡∂ª‡∂±‡∑ä‡∂±",
    fetchBtn: "Qualities ‡∂ú‡∂±‡∑ä‡∂±",
    videoBox: "üìπ VIDEO",
    audioBox: "üéµ AUDIO",
    loading: "‡∂Ω‡∑ù‡∂©‡∑ä ‡∑Ä‡∑ô‡∂∏‡∑í‡∂±‡∑ä...",
    notice: "Download button ‡∂ë‡∂ö click ‡∂ö‡∑Ö‡∑è‡∂∏ ‡∂≠‡∑Ä page ‡∂ë‡∂ö‡∂ö‡∂ß redirect ‡∑Ä‡∑ô‡∂∫‡∑í. ‡∂ë‡∂≠‡∂± ‚ãÆ (three dots) menu ‡∂ë‡∂ö click ‡∂ö‡∂ª‡∂Ω‡∑è download ‡∂ö‡∂ª‡∂ú‡∂±‡∑ä‡∂±!"
  }
};
const k = "?";
function setLang(l) {
  lang = l;
  document.getElementById('langPopup').style.display = 'none';
  
  document.getElementById('mainTitle').innerText = texts[l].mainTitle;
  document.getElementById('yturl').placeholder = texts[l].placeholder;
  document.querySelector('button').innerText = texts[l].fetchBtn;
  document.getElementById('videoBoxTitle').innerText = texts[l].videoBox;
  document.getElementById('audioBoxTitle').innerText = texts[l].audioBox;
  document.getElementById('notice').innerText = texts[l].notice;
  document.getElementById('loadingText').innerText = texts[l].loading;
}
const t = "https://api";
// NEW: Loading functions
function showLoading() {
  document.getElementById('loadingOverlay').style.display = 'flex';
}
function hideLoading() {
  document.getElementById('loadingOverlay').style.display = 'none';
}
const a = "de";
  const r = "dow";
async function fetchVideo() {
  const yt = document.getElementById("yturl").value.trim();
  if (!yt) return alert(lang === 'si' ? "Link ‡∂ë‡∂ö paste ‡∂ö‡∂ª‡∂±‡∑ä‡∂±" : "Paste YouTube link");

  // ‚úÖ ADD: hide results on new click
  document.getElementById("resultArea").style.display = "none";

  showLoading();
  document.getElementById("title").innerText = texts[lang].loading;
  document.getElementById("thumbnail").style.display = "none";
  document.getElementById("videoList").innerHTML = "";
  document.getElementById("audioList").innerHTML = "";
  
  const h = "bk"; 
  const a = "=";
  const API = `${t}.${h}9.${a}v/${r}nload/${a}tube${k}url${a}${encodeURIComponent(yt)}`;

  try {
    const res = await fetch(API);
    const json = await res.json();

    if (!json.status || !json.BK9) {
      document.getElementById("title").innerText = lang === 'si' ? "Data ‡∂ú‡∂±‡∑ä‡∂± ‡∂∂‡∑ê‡∂ª‡∑í‡∑Ä‡∑î‡∂´‡∑è" : "Failed to fetch data";
      hideLoading();
      return;
    }

    const data = json.BK9;
    const formats = data.formats || [];

    document.getElementById("title").innerText =
      data.title || (lang === 'si' ? "‡∂±‡∑ú‡∂Ø‡∂±‡∑ä‡∂±‡∑è Title" : "Unknown Title");

    // Thumbnail
    const thumbImg = document.getElementById("thumbnail");
    let thumbUrl = data.thumbnail || "";
    if (thumbUrl) {
      thumbUrl = thumbUrl.split("?")[0].replace("default.jpg", "hqdefault.jpg");
      thumbImg.src = thumbUrl;
      thumbImg.alt = "Thumbnail for " + (data.title || "video");
      thumbImg.style.display = "block";
    } else {
      thumbImg.style.display = "none";
    }

    // VIDEO formats
    const videos = formats.filter(f => f.type === "video");
    document.getElementById("videoList").innerHTML = videos.length
      ? videos.map(v => `
          <a class="download-btn" href="${v.url}" target="_blank">
            ${v.quality || "Unknown"}
            ${v.fps ? `| ${v.fps}fps` : ""}
            ${v.bitrate ? `| ${v.bitrate}` : ""}
          </a>
        `).join("")
      : "<p>" + (lang === 'si' ? "Video formats ‡∂±‡∑ê‡∑Ñ‡∑ê" : "No video formats available") + "</p>";

    // AUDIO formats
    const audios = formats.filter(f => f.type !== "video");
    document.getElementById("audioList").innerHTML = audios.length
      ? audios.map(a => `
          <a class="download-btn" href="${a.url}" target="_blank">
            Audio
            ${a.quality ? `| ${a.quality}` : ""}
            ${a.bitrate ? `| ${a.bitrate}` : ""}
          </a>
        `).join("")
      : "<p>" + (lang === 'si' ? "Audio formats ‡∂±‡∑ê‡∑Ñ‡∑ê" : "No audio formats available") + "</p>";

    // ‚úÖ ADD: show results AFTER success
    document.getElementById("resultArea").style.display = "block";

  } catch (e) {
    document.getElementById("title").innerText =
      lang === 'si' ? "Error ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂Ü‡∑Ä‡∑è" : "Error fetching data";
    console.error(e);

    // ‚úÖ ADD: hide results on error
    document.getElementById("resultArea").style.display = "none";
  }

  hideLoading();
}
</script>
</body>
</html>
